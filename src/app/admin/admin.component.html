<div class="admin-container" [class.dark-theme]="isDarkTheme">
    <!-- Боковое меню -->
    <aside class="sidemenu">
        <div class="logo-section">
            <i class="fas fa-building"></i>
            <div class="logo-text">
                <span class="logo-title">Админ<span class="accent">Панель</span></span>
                <span class="logo-subtitle">Система управления</span>
            </div>
        </div>
        
        <nav>
            <ul>
                <!-- Дашборд (доступен всем ролям) -->
                <li [class.active]="currentSection === 'dashboard'" *ngIf="hasAccessToSection('dashboard')">
                    <a routerLink="/admin" routerLinkActive="active" (click)="switchToSection('dashboard')">
                        <i class="fas fa-chart-line"></i>
                        <span>Дашборд</span>
                    </a>
                </li>
                
                <!-- Сотрудники (только для ADMIN и MANAGER) -->
                <li [class.active]="currentSection === 'employees'" *ngIf="hasAccessToSection('employees')">
                    <a routerLink="/admin/employees" routerLinkActive="active" (click)="switchToSection('employees')">
                        <i class="fas fa-users"></i>
                        <span>Сотрудники</span>
                    </a>
                </li>
                
                <!-- Объекты (только для ADMIN и MANAGER) -->
                <li [class.active]="currentSection === 'facilities'" *ngIf="hasAccessToSection('facilities')">
                    <a routerLink="/admin/facilities" routerLinkActive="active" (click)="switchToSection('facilities')">
                        <i class="fas fa-building"></i>
                        <span>Объекты</span>
                    </a>
                </li>
                
                <!-- Оборудование (для ADMIN, MANAGER, EMPLOYEE) -->
                <li [class.active]="currentSection === 'equipment'" *ngIf="hasAccessToSection('equipment')">
                    <a routerLink="/admin/equipment" routerLinkActive="active" (click)="switchToSection('equipment')">
                        <i class="fas fa-tools"></i>
                        <span>Оборудование</span>
                    </a>
                </li>
                
                <!-- Новости (доступно для всех авторизованных пользователей) -->
                <li [class.active]="currentSection === 'news'" *ngIf="hasAccessToSection('news')">
                    <a routerLink="/admin/news" routerLinkActive="active" (click)="switchToSection('news')">
                        <i class="fas fa-pen"></i>
                        <span>Новости</span>
                    </a>
                </li>
                
                <!-- Отчеты (только для ADMIN и MANAGER) -->
                <li [class.active]="currentSection === 'reports'" *ngIf="hasAccessToSection('reports')">
                    <a routerLink="/admin/reports" routerLinkActive="active" (click)="switchToSection('reports')">
                        <i class="fas fa-file-alt"></i>
                        <span>Отчеты</span>
                    </a>
                </li>
                
                <!-- Расчеты (для ADMIN, MANAGER, EMPLOYEE) -->
                <li [class.active]="currentSection === 'calculations'" *ngIf="hasAccessToSection('calculations')">
                    <a routerLink="/admin/calculations" routerLinkActive="active" (click)="switchToSection('calculations')">
                        <i class="fas fa-calculator"></i>
                        <span>Расчеты</span>
                    </a>
                </li>
                
                <!-- Отзывы (для ADMIN, MANAGER, EMPLOYEE) -->
                <li [class.active]="currentSection === 'reviews'" *ngIf="hasAccessToSection('reviews')">
                    <a routerLink="/admin/reviews" routerLinkActive="active" (click)="switchToSection('reviews')">
                        <i class="fas fa-comments"></i>
                        <span>Отзывы</span>
                    </a>
                </li>
                
                <!-- Обратная связь (для ADMIN, MANAGER) -->
                <li [class.active]="currentSection === 'feedback'" *ngIf="hasAccessToSection('feedback')">
                    <a routerLink="/admin/feedback" routerLinkActive="active" (click)="switchToSection('feedback')">
                        <i class="fas fa-headset"></i>
                        <span>Обратная связь</span>
                    </a>
                </li>
                
                <!-- Настройки (только для ADMIN) -->
                <li [class.active]="currentSection === 'settings'" *ngIf="hasAccessToSection('settings')">
                    <a routerLink="/admin/settings" routerLinkActive="active" (click)="switchToSection('settings')">
                        <i class="fas fa-cog"></i>
                        <span>Настройки</span>
                    </a>
                </li>
            </ul>
        </nav>

        <div class="user-section">
            <div class="user-info">
                <i class="fas fa-user-circle"></i>
                <div class="user-details">
                    <span class="user-name">{{userName || 'Пользователь'}}</span>
                    <span class="user-role">{{getRoleInRussian()}}</span>
                </div>
            </div>
            <button class="logout-btn" (click)="logout()">
                <i class="fas fa-sign-out-alt"></i>
                <span>Выйти</span>
            </button>
        </div>
    </aside>

    <!-- Основной контент -->
    <main class="content">
        <header class="header">
            <h2>{{pageTitle}}</h2>
            <div class="header-actions">
                <button class="notification-btn" title="Уведомления">
                    <i class="fas fa-bell"></i>
                    <div class="notification-badge">3</div>
                </button>
                <button class="theme-toggle" (click)="toggleTheme()" title="Сменить тему">
                    <i class="fas" [class.fa-moon]="!isDarkTheme" [class.fa-sun]="isDarkTheme"></i>
                </button>
            </div>
        </header>

        <!-- Дашборд (по умолчанию) -->
        <div *ngIf="currentSection === 'dashboard'">
            <!-- Статистика -->
            <section class="stats-container">
                <h3>Общая статистика</h3>
                <div class="stat-card">
                    <div class="stat-item">
                        <div class="stat-icon employees">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <span class="number">{{totalEmployees}}</span>
                            <span class="trend">Всего сотрудников</span>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon facilities">
                            <i class="fas fa-building"></i>
                        </div>
                        <div class="stat-info">
                            <span class="number">{{totalFacilities}}</span>
                            <span class="trend">Всего объектов</span>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon workload">
                            <i class="fas fa-chart-pie"></i>
                        </div>
                        <div class="stat-info">
                            <span class="number">{{averageWorkload}}%</span>
                            <span class="trend">Средняя загрузка</span>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon equipment">
                            <i class="fas fa-tools"></i>
                        </div>
                        <div class="stat-info">
                            <span class="number">{{equipment.length}}</span>
                            <span class="trend">Всего оборудования</span>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Раздел сотрудников -->
        <div *ngIf="currentSection === 'employees'">
            <section class="data-table">
                <div class="table-header">
                    <div class="header-left">
                        <h3>Сотрудники</h3>
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" 
                                   [(ngModel)]="employeeSearchQuery" 
                                   (ngModelChange)="onEmployeeSearch($any($event))"
                                   placeholder="Поиск по имени, должности или email...">
                        </div>
                    </div>
                    <button class="add-btn" (click)="onAddEmployee()">
                        <i class="fas fa-plus"></i>
                        <span>Добавить сотрудника</span>
                    </button>
                </div>
                <div *ngIf="!filteredEmployees || filteredEmployees.length === 0" class="no-data">
                    <i class="fas fa-search"></i>
                    <p>{{employeeSearchQuery ? 'Ничего не найдено' : 'Нет данных о сотрудниках'}}</p>
                </div>
                <table *ngIf="filteredEmployees && filteredEmployees.length > 0">
                    <thead>
                        <tr>
                            <th>Сотрудник</th>
                            <th>Должность</th>
                            <th>Email</th>
                            <th>Телефон</th>
                            <th>Дата добавления</th>
                            <th>Действия</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let employee of filteredEmployees">
                            <td>
                                <div class="employee-info">
                                    <i class="fas fa-user"></i>
                                    <span>{{employee.name}}</span>
                                </div>
                            </td>
                            <td>{{employee.position}}</td>
                            <td>{{employee.email}}</td>
                            <td>{{employee.phone}}</td>
                            <td>{{employee.created_at | date:'dd.MM.yyyy HH:mm'}}</td>
                            <td>
                                <div class="action-buttons">
                                    <button class="action-btn edit" (click)="onEditEmployee(employee)">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="action-btn delete" (click)="onDeleteEmployee(employee)">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>
        </div>

        <!-- Раздел объектов -->
        <div *ngIf="currentSection === 'facilities'">
            <section class="data-table">
                <div class="table-header">
                    <div class="header-left">
                        <h3>Объекты</h3>
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" 
                                   [(ngModel)]="facilitySearchQuery" 
                                   (ngModelChange)="onFacilitySearch($any($event))"
                                   placeholder="Поиск по названию, адресу или типу...">
                        </div>
                    </div>
                    <button class="add-btn" (click)="onAddFacility()">
                        <i class="fas fa-plus"></i>
                        <span>Добавить объект</span>
                    </button>
                </div>

                <div *ngIf="!filteredFacilities || filteredFacilities.length === 0" class="no-data">
                    <i class="fas fa-search"></i>
                    <p>{{facilitySearchQuery ? 'Ничего не найдено' : 'Нет данных об объектах'}}</p>
                </div>

                <table *ngIf="filteredFacilities && filteredFacilities.length > 0">
                    <thead>
                        <tr>
                            <th>Объект</th>
                            <th>Адрес</th>
                            <th>Тип</th>
                            <th>Стоимость</th>
                            <th>Статус</th>
                            <th>Действия</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let facility of filteredFacilities">
                            <td>
                                <div class="facility-info">
                                    <i class="fas" [ngClass]="{
                                        'fa-building': facility.type === 'Офис',
                                        'fa-warehouse': facility.type === 'Склад',
                                        'fa-industry': facility.type === 'Производство',
                                        'fa-store': facility.type === 'Торговля'
                                    }"></i>
                                    <span>{{facility.name}}</span>
                                </div>
                            </td>
                            <td>{{facility.address}}</td>
                            <td>
                                <span class="facility-type" [ngClass]="facility.type.toLowerCase()">
                                    {{facility.type}}
                                </span>
                            </td>
                            <td>{{facility.cost | currency:'RUB':'₽':'1.0-0'}}</td>
                            <td>
                                <span class="status" 
                                    [class.active]="facility.status === 'active'"
                                    [class.inactive]="facility.status === 'inactive'"
                                    [class.ready]="facility.status === 'ready'"
                                    [class.ready-to-rent]="facility.status === 'ready_to_rent'"
                                    [class.rented]="facility.status === 'rented'">
                                    <ng-container [ngSwitch]="facility.status">
                                        <ng-container *ngSwitchCase="'active'">Активен</ng-container>
                                        <ng-container *ngSwitchCase="'inactive'">Неактивен</ng-container>
                                        <ng-container *ngSwitchCase="'ready'">Готов</ng-container>
                                        <ng-container *ngSwitchCase="'ready_to_rent'">Готов к сдаче</ng-container>
                                        <ng-container *ngSwitchCase="'rented'">Сдан</ng-container>
                                    </ng-container>
                                </span>
                            </td>
                            <td>
                                <div class="action-buttons">
                                    <button class="action-btn view" (click)="onViewFacility(facility)" title="Просмотр">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="action-btn edit" (click)="onEditFacility(facility)" title="Редактировать">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="action-btn delete" (click)="onDeleteFacility(facility)" title="Удалить">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>
        </div>

        <!-- Раздел оборудования -->
        <div *ngIf="currentSection === 'equipment'">
            <section class="data-table">
                <div class="table-header">
                    <div class="header-left">
                        <h3>Оборудование</h3>
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" 
                                   [(ngModel)]="equipmentSearchQuery" 
                                   (ngModelChange)="onEquipmentSearch($any($event))"
                                   placeholder="Поиск по названию, типу или местоположению...">
                        </div>
                    </div>
                    <button class="add-btn" (click)="onShowAddEquipmentModal()">
                        <i class="fas fa-plus"></i>
                        <span>Добавить оборудование</span>
                    </button>
                </div>
                <div *ngIf="!filteredEquipment || filteredEquipment.length === 0" class="no-data">
                    <i class="fas fa-search"></i>
                    <p>{{equipmentSearchQuery ? 'Ничего не найдено' : 'Нет данных об оборудовании'}}</p>
                </div>
                <table *ngIf="filteredEquipment && filteredEquipment.length > 0">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Название</th>
                            <th>Тип</th>
                            <th>Местоположение</th>
                            <th>Статус</th>
                            <th>Последнее ТО</th>
                            <th>Следующее ТО</th>
                            <th>Действия</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of filteredEquipment">
                            <td>{{ item.id }}</td>
                            <td>{{ item.name }}</td>
                            <td>{{ item.type }}</td>
                            <td>{{ item.location }}</td>
                            <td>
                                <span class="status" [class.active]="item.status === 'active'">
                                    {{item.status === 'active' ? 'Активно' : 
                                      item.status === 'inactive' ? 'Неактивно' : 'На обслуживании'}}
                                </span>
                            </td>
                            <td>{{item.lastMaintenance | date:'dd.MM.yyyy'}}</td>
                            <td>{{item.nextMaintenance | date:'dd.MM.yyyy'}}</td>
                            <td>
                                <div class="action-buttons">
                                    <button class="action-btn edit" (click)="onEditEquipment(item)">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="action-btn delete" (click)="onDeleteEquipment(item)">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>
        </div>

        <!-- Раздел новостей -->
        <div *ngIf="currentSection === 'news'">
            <section class="data-table">
                <div class="table-header">
                    <div class="header-left">
                        <h3>Новости</h3>
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" 
                                   [(ngModel)]="newsSearchQuery" 
                                   (ngModelChange)="onNewsSearch($any($event))"
                                   placeholder="Поиск по заголовку или содержанию...">
                        </div>
                    </div>
                    <button class="add-btn" (click)="onAddNews()">
                        <i class="fas fa-plus"></i>
                        <span>Добавить новость</span>
                    </button>
                </div>
                <div *ngIf="!filteredNews || filteredNews.length === 0" class="no-data">
                    <i class="fas fa-search"></i>
                    <p>{{newsSearchQuery ? 'Ничего не найдено' : 'Нет данных о новостях'}}</p>
                </div>
                <table *ngIf="filteredNews && filteredNews.length > 0">
                    <thead>
                        <tr>
                            <th>Заголовок</th>
                            <th>Содержание</th>
                            <th>Дата</th>
                            <th>Автор</th>
                            <th>Действия</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let news of filteredNews">
                            <td>{{news.title}}</td>
                            <td>{{news.content}}</td>
                            <td>{{news.date | date:'d MMMM yyyy'}}</td>
                            <td>{{news.author}}</td>
                            <td>
                                <div class="action-buttons">
                                    <button class="action-btn edit" (click)="onEditNews(news)">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="action-btn delete" (click)="onDeleteNews(news)">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>
        </div>

        <!-- Раздел отчетов -->
        <div *ngIf="currentSection === 'reports'">
            <section class="data-table">
                <div class="table-header">
                    <div class="header-left">
                        <h3>Отчеты</h3>
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" 
                                   [(ngModel)]="reportSearchQuery" 
                                   (ngModelChange)="onReportSearch($any($event))"
                                   placeholder="Поиск по названию или типу...">
                        </div>
                    </div>
                    <button class="add-btn" (click)="onAddReport()">
                        <i class="fas fa-plus"></i>
                        <span>Создать отчет</span>
                    </button>
                </div>
                <div *ngIf="!filteredReports || filteredReports.length === 0" class="no-data">
                    <i class="fas fa-search"></i>
                    <p>{{reportSearchQuery ? 'Ничего не найдено' : 'Нет данных об отчетах'}}</p>
                </div>
                <table *ngIf="filteredReports && filteredReports.length > 0">
                    <thead>
                        <tr>
                            <th>Название</th>
                            <th>Тип</th>
                            <th>Дата</th>
                            <th>Статус</th>
                            <th>Автор</th>
                            <th>Действия</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let report of filteredReports">
                            <td>{{report.title}}</td>
                            <td>
                                <span class="badge" [ngClass]="report.type">
                                    {{report.type === 'financial' ? 'Финансовый' : 
                                      report.type === 'operational' ? 'Операционный' : 'Обслуживание'}}
                                </span>
                            </td>
                            <td>{{report.date | date:'dd.MM.yyyy'}}</td>
                            <td>
                                <span class="status" [class.active]="report.status === 'published'">
                                    {{report.status === 'published' ? 'Опубликован' : 'Черновик'}}
                                </span>
                            </td>
                            <td>{{report.author}}</td>
                            <td>
                                <div class="action-buttons">
                                    <button class="action-btn view" (click)="onViewReport(report)">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="action-btn edit" (click)="onEditReport(report)">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="action-btn delete" (click)="onDeleteReport(report)">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>
        </div>

        <!-- Раздел расчетов -->
        <div *ngIf="currentSection === 'calculations'">
            <section class="data-table">
                <div class="table-header">
                    <div class="header-left">
                        <h3>Расчеты</h3>
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" 
                                   [(ngModel)]="calculationSearchQuery" 
                                   (ngModelChange)="onCalculationSearch($any($event))"
                                   placeholder="Поиск по названию или типу...">
                        </div>
                    </div>
                    <button class="add-btn" (click)="onAddCalculation()">
                        <i class="fas fa-plus"></i>
                        <span>Новый расчет</span>
                    </button>
                </div>
                <div *ngIf="!filteredCalculations || filteredCalculations.length === 0" class="no-data">
                    <i class="fas fa-search"></i>
                    <p>{{calculationSearchQuery ? 'Ничего не найдено' : 'Нет данных о расчетах'}}</p>
                </div>
                <table *ngIf="filteredCalculations && filteredCalculations.length > 0">
                    <thead>
                        <tr>
                            <th>Название</th>
                            <th>Тип</th>
                            <th>Дата</th>
                            <th>Результат</th>
                            <th>Действия</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let calculation of filteredCalculations">
                            <td>{{calculation.name}}</td>
                            <td>
                                <span class="badge" [ngClass]="calculation.type">
                                    {{calculation.type === 'cost' ? 'Стоимость' : 
                                      calculation.type === 'efficiency' ? 'Эффективность' : 'Обслуживание'}}
                                </span>
                            </td>
                            <td>{{calculation.date | date:'dd.MM.yyyy'}}</td>
                            <td>
                                <span class="result" [ngClass]="calculation.type">
                                    {{calculation.result | number:'1.2-2'}}
                                    {{calculation.type === 'efficiency' ? '%' : '₽'}}
                                </span>
                            </td>
                            <td>
                                <div class="action-buttons">
                                    <button class="action-btn view" (click)="onViewCalculation(calculation)">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="action-btn edit" (click)="onEditCalculation(calculation)">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="action-btn delete" (click)="onDeleteCalculation(calculation)">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>
        </div>

        <!-- Раздел отзывов -->
        <div *ngIf="currentSection === 'reviews'">
            <section class="data-table">
                <div class="table-header">
                    <div class="header-left">
                        <h3>Модерация отзывов</h3>
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" 
                                   [(ngModel)]="reviewSearchQuery" 
                                   (ngModelChange)="onReviewSearch($any($event))"
                                   placeholder="Поиск по автору или содержанию...">
                        </div>
                    </div>
                </div>
                <div *ngIf="!filteredReviews || filteredReviews.length === 0" class="no-data">
                    <i class="fas fa-search"></i>
                    <p>{{reviewSearchQuery ? 'Ничего не найдено' : 'Нет отзывов для модерации'}}</p>
                </div>
                <table *ngIf="filteredReviews && filteredReviews.length > 0">
                    <thead>
                        <tr>
                            <th>Автор</th>
                            <th>Объект</th>
                            <th>Оценка</th>
                            <th>Содержание</th>
                            <th>Дата</th>
                            <th>Статус</th>
                            <th>Действия</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let review of filteredReviews">
                            <td>{{review.author}}</td>
                            <td>{{review.facility}}</td>
                            <td>
                                <div class="rating">
                                    <i class="fas fa-star" *ngFor="let star of [1,2,3,4,5]" 
                                       [class.active]="star <= review.rating"></i>
                                </div>
                            </td>
                            <td>{{review.content}}</td>
                            <td>{{review.date | date:'d MMMM yyyy'}}</td>
                            <td>
                                <span class="status" [ngClass]="review.status">
                                    {{review.status === 'pending' ? 'На модерации' : 
                                      review.status === 'approved' ? 'Одобрен' : 'Отклонен'}}
                                </span>
                            </td>
                            <td>
                                <div class="action-buttons">
                                    <button class="action-btn approve" *ngIf="review.status === 'pending'"
                                            (click)="onApproveReview(review)" title="Одобрить">
                                        <i class="fas fa-check"></i>
                                    </button>
                                    <button class="action-btn reject" *ngIf="review.status === 'pending'"
                                            (click)="onRejectReview(review)" title="Отклонить">
                                        <i class="fas fa-times"></i>
                                    </button>
                                    <button class="action-btn response" *ngIf="review.status === 'approved'"
                                            (click)="onAddResponse(review)" title="Ответить">
                                        <i class="fas fa-reply"></i>
                                    </button>
                                    <button class="action-btn delete" (click)="onDeleteReview(review)" title="Удалить">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>
        </div>

        <!-- Раздел обратной связи -->
        <div *ngIf="currentSection === 'feedback'" class="feedback-container">
            <div class="feedback-list">
                <div class="feedback-item" *ngFor="let feedback of feedbacks" 
                     [class.active]="selectedFeedback?.id === feedback.id"
                     (click)="onSelectFeedback(feedback)">
                    <div class="feedback-header">
                        <div class="feedback-info">
                            <h4>{{feedback.subject}}</h4>
                            <span class="author">{{feedback.author}}</span>
                        </div>
                        <div class="feedback-meta">
                            <span class="date">{{feedback.date | date:'d MMMM yyyy'}}</span>
                            <span class="status" [ngClass]="feedback.status">
                                {{feedback.status === 'new' ? 'Новое' : 
                                  feedback.status === 'in_progress' ? 'В работе' : 
                                  feedback.status === 'resolved' ? 'Решено' : 'Закрыто'}}
                            </span>
                            <span class="priority" [ngClass]="feedback.priority">
                                {{feedback.priority === 'high' ? 'Высокий' : 
                                  feedback.priority === 'medium' ? 'Средний' : 'Низкий'}}
                            </span>
                        </div>
                    </div>
                    <p class="message">{{feedback.message}}</p>
                </div>
            </div>
            
            <div class="feedback-detail" *ngIf="selectedFeedback">
                <div class="feedback-detail-header">
                    <h3>{{selectedFeedback.subject}}</h3>
                    <div class="feedback-actions">
                        <button class="action-btn" [ngClass]="selectedFeedback.status"
                                (click)="onUpdateStatus(selectedFeedback)">
                            {{selectedFeedback.status === 'new' ? 'Взять в работу' : 
                              selectedFeedback.status === 'in_progress' ? 'Решено' : 
                              selectedFeedback.status === 'resolved' ? 'Закрыть' : 'Открыть'}}
                        </button>
                        <button class="action-btn delete" (click)="onDeleteFeedback(selectedFeedback)">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                
                <div class="feedback-messages">
                    <div class="message user">
                        <div class="message-header">
                            <span class="author">{{selectedFeedback.author}}</span>
                            <span class="date">{{selectedFeedback.date | date:'d MMMM yyyy, HH:mm'}}</span>
                        </div>
                        <div class="message-content">
                            {{selectedFeedback.message}}
                        </div>
                    </div>
                    
                    <div class="message admin" *ngFor="let response of selectedFeedback.responses">
                        <div class="message-header">
                            <span class="author">{{response.author}}</span>
                            <span class="date">{{response.date | date:'d MMMM yyyy, HH:mm'}}</span>
                        </div>
                        <div class="message-content">
                            {{response.message}}
                        </div>
                    </div>
                </div>
                
                <div class="feedback-response">
                    <textarea [(ngModel)]="newResponse" 
                              placeholder="Введите ваш ответ..."
                              rows="3"></textarea>
                    <button class="send-btn" (click)="onSendResponse()">
                        <i class="fas fa-paper-plane"></i>
                        Отправить
                    </button>
                </div>
            </div>
        </div>

        <!-- Раздел настроек -->
        <div *ngIf="currentSection === 'settings'">
            <section class="data-table">
                <div class="table-header">
                    <h3>Настройки системы</h3>
                </div>
                <div class="settings-container">
                    <div class="settings-group" *ngFor="let category of settingCategories">
                        <h4>
                            <i class="fas" [ngClass]="{
                                'fa-cog': category.id === 'system',
                                'fa-bell': category.id === 'notification',
                                'fa-shield-alt': category.id === 'security',
                                'fa-paint-brush': category.id === 'appearance'
                            }"></i>
                            {{category.title}}
                        </h4>
                        <div class="settings-list">
                            <div class="setting-item" *ngFor="let setting of getSettingsByCategory(category.id)">
                                <div class="setting-info">
                                    <span class="setting-name">{{setting.name}}</span>
                                    <span class="setting-description">{{setting.description}}</span>
                                </div>
                                <div class="setting-control">
                                    <ng-container [ngSwitch]="typeof setting.value">
                                        <select *ngSwitchCase="'string'" 
                                                [(ngModel)]="setting.value"
                                                (change)="onSettingChange(setting)">
                                            <option value="ru">Русский</option>
                                            <option value="en">English</option>
                                        </select>
                                        <select *ngSwitchCase="'boolean'" 
                                                [(ngModel)]="setting.value"
                                                (change)="onSettingChange(setting)">
                                            <option [ngValue]="true">Включено</option>
                                            <option [ngValue]="false">Выключено</option>
                                        </select>
                                    </ng-container>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <app-add-employee-modal
            *ngIf="showAddEmployeeModal"
            [employeeToEdit]="selectedEmployee"
            [isDarkTheme]="isDarkTheme"
            (close)="onCloseAddEmployeeModal()"
            (employeeAdded)="onEmployeeAdded($any($event))"
            (employeeUpdated)="onEmployeeUpdated($any($event))">
        </app-add-employee-modal>

        <!-- Модальное окно добавления/редактирования объекта -->
        <app-add-facility-modal 
            *ngIf="showAddFacilityModal" 
            [facilityToEdit]="selectedFacility"
            [isDarkTheme]="isDarkTheme"
            (close)="onCloseAddFacilityModal()"
            (facilityAdded)="onFacilityAdded($any($event))"
            (facilityUpdated)="onFacilityUpdated($any($event))">
        </app-add-facility-modal>

        <!-- Модальное окно добавления/редактирования новостей -->
        <app-add-news-modal
            *ngIf="showAddNewsModal"
            [newsToEdit]="selectedNews"
            [isDarkTheme]="isDarkTheme"
            (close)="onCloseAddNewsModal()"
            (newsAdded)="onNewsAdded($any($event))"
            (newsUpdated)="onNewsUpdated($any($event))">
        </app-add-news-modal>

        <!-- Модальное окно добавления/редактирования оборудования -->
        <app-add-equipment-modal
            *ngIf="showAddEquipmentModal"
            [equipmentToEdit]="selectedEquipment"
            [isDarkTheme]="isDarkTheme"
            (close)="onCloseAddEquipmentModal()"
            (equipmentAdded)="onEquipmentAdded($any($event))"
            (equipmentUpdated)="onEquipmentUpdated($any($event))">
        </app-add-equipment-modal>
    </main>
</div>
